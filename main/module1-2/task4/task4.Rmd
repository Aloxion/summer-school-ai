---
title: "Task4"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
load("../../module1/.RData")
```

```{r}
```{r}
# Install if needed. OUTCOMMENT install.package("pROC"), ITS BEIN SUSSY
#install.packages("pROC")

# Load package
library(dplyr)
library(pROC)

# Select biomarker columns
biomarkers <- merged_all %>%
  select(monocyte:coag_factor)

# Perform PCA
pca.model <- prcomp(biomarkers, center = TRUE, scale. = TRUE)

# Summary of PCA (explained variance)
summary(pca.model)


# Variance explained
explained_var <- pca.model$sdev^2 / sum(pca.model$sdev^2)

barplot(explained_var,
        main = "Proportion of Variance Explained by Each PC",
        xlab = "Principal Component",
        ylab = "Proportion of Variance",
        names.arg = paste0("PC", 1:length(explained_var)))

eigenvalues <- pca.model$sdev^2
print(eigenvalues)

# Loadings (how each original variable contributes to each PC)
print(round(pca.model$rotation[, 1:4], 2))  # Adjust number of PCs as needed

components <- as.data.frame(pca.model$x[, 1:3])  # PCs 1â€“3
colnames(components) <- c("PC1", "PC2", "PC3")

# Merge with main dataset
merged_all_pca <- bind_cols(merged_all, components)

save.image(file = '../.RData')
```
